import{s as ut,r as D,f as pt,J as S,n as vt,j as c,v as d,y as t,F as C,G as k,I as r,E as A,z as K,u as Z,K as tt,x as et}from"./vendor-a1a62974.js";import{d as x,a as mt}from"./index-912f96f0.js";import{p as P,q as w,M as st,x as at,K as U}from"./firebase-1b009ed5.js";import{C as I}from"./auto-69f04699.js";import{_ as ot}from"./_plugin-vue_export-helper-c27b6911.js";import{F as bt}from"./FloatingIcons-e36b23d3.js";const yt={class:"section dashboard-summary-section"},ht={class:"container"},ft={class:"columns is-multiline mb-4"},_t={class:"card summary-card"},gt={class:"card-content py-4 px-3"},Dt={class:"is-flex is-align-items-center is-justify-content-space-between"},xt={class:"title is-4 mb-1"},Ct={class:"subtitle is-6 text-secondary"},kt={class:"icon is-large"},wt={class:"columns mb-4"},It={class:"column is-6"},Tt={class:"card"},Et={class:"card-content py-3 px-3"},Mt={class:"dashboard-canvas-wrapper"},St={class:"column is-6"},At={class:"card"},zt={class:"card-content py-3 px-3"},$t={class:"dashboard-canvas-wrapper"},Pt={class:"columns mb-4"},Bt={class:"column is-8"},Ft={class:"card"},Nt={class:"card-content"},Rt={class:"task-boards"},jt={class:"task-list"},Gt=["onDragstart"],Ot={class:"task-content"},Lt={class:"task-title"},Jt=["onClick"],Vt={class:"task-list"},Wt=["onDragstart"],Ht={class:"task-content"},Kt={class:"task-title"},Ut=["onClick"],Yt={class:"task-list"},qt=["onDragstart"],Qt={class:"task-content"},Xt={class:"task-title"},Zt={class:"task-date"},te={class:"column is-4"},ee={class:"card"},se={class:"card-content"},ae={class:"calendar-events"},oe={class:"event-time"},ne={class:"event-content"},le={class:"event-title"},ie={class:"columns mb-4"},re={class:"column is-6"},ce={class:"card"},de={class:"card-content"},ue={class:"wallet-summary"},pe={class:"balance-card bg-primary"},ve={class:"balance-amount"},me={class:"wallet-stats"},be={class:"stat-item"},ye={class:"stat-value text-accent"},he={class:"stat-item"},fe={class:"stat-value text-warning"},_e={class:"recent-transactions"},ge={class:"transaction-info"},De={class:"transaction-title"},xe={class:"transaction-date"},Ce={class:"column is-6"},ke={class:"card"},we={class:"card-content"},Ie={class:"meal-planning"},Te={class:"title is-6 mb-2"},Ee={class:"meal-items"},Me={class:"meal-type"},Se={class:"meal-name"},Ae={class:"meal-calories"},ze={class:"columns mb-4"},$e={class:"column is-12"},Pe={class:"card"},Be={class:"card-content py-3 px-3"},Fe={class:"dashboard-canvas-wrapper"},Ne={__name:"DashboardSummary",setup(nt){const B=ut(),E=D(null),b=D(null),y=D(null),h=D(null),lt=pt(()=>{const n=F.value.length+N.value.length,e=R.value.length,s=T.value.balance,o=Object.values(j.value).reduce((a,m)=>a+m.meals.length,0);return[{title:"Tareas Pendientes",value:n,icon:"bx-task",color:"warning"},{title:"Eventos Hoy",value:e,icon:"bx-calendar",color:"primary"},{title:"Balance Mensual",value:"$"+s,icon:"bx-wallet",color:"accent"},{title:"Comidas Planificadas",value:o,icon:"bx-restaurant",color:"secondary"}]}),F=D([]),N=D([]),z=D([]),f=()=>{var n;return(n=mt.currentUser)==null?void 0:n.uid};S(()=>{P(w(x,"tasks"),n=>{const e=f();if(!e)return;const o=n.docs.map(a=>({id:a.id,...a.data()})).filter(a=>a.userId===e);F.value=o.filter(a=>a.status==="todo"),N.value=o.filter(a=>a.status==="progress"),z.value=o.filter(a=>a.status==="completed")})});const R=D([]);S(()=>{P(w(x,"events"),n=>{const e=f();if(!e)return;const s=n.docs.map(a=>({id:a.id,...a.data()})),o=new Date().toISOString().split("T")[0];R.value=s.filter(a=>a.date===o&&a.userId===e)})});const T=D({balance:0,income:0,expenses:0,recentTransactions:[]});S(()=>{P(w(x,"transactions"),n=>{const e=f();if(!e)return;const s=n.docs.map(p=>({id:p.id,...p.data()})),o=new Date().getMonth(),a=new Date().getFullYear();let m=0,_=0;s.filter(p=>{const i=new Date(p.date);return i.getMonth()===o&&i.getFullYear()===a&&p.userId===e}).forEach(p=>{p.type==="income"&&(m+=Number(p.amount)),p.type==="expense"&&(_+=Number(p.amount))}),T.value={balance:m-_,income:m,expenses:_,recentTransactions:s.slice(0,3).filter(p=>p.userId===e)}})});const j=D({});S(()=>{P(w(x,"meals"),n=>{const e=f();if(!e)return;const s=n.docs.map(a=>({id:a.id,...a.data()}));["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"].forEach((a,m)=>{const _=new Date;_.setDate(_.getDate()+m);const H=_.toISOString().split("T")[0],p=s.filter(i=>i.date===H&&i.userId===e);j.value[a]={day:a,meals:p.map(i=>({type:i.type,name:i.name,calories:i.calories}))}})})});const G=(n,e)=>{E.value=e,n.target.style.opacity="0.5"},O=n=>{n.target.style.opacity="1",E.value=null},L=async(n,e)=>{if(n.preventDefault(),!!E.value)try{const s=f();if(!s)return;await st(at(x,"tasks",E.value.id),{status:e,completedDate:e==="completed"?new Date().toLocaleDateString():null,userId:s})}catch(s){console.error("Error al mover la tarea:",s)}},Y=async(n,e)=>{try{const s=f();if(!s)return;await st(at(x,"tasks",n),{status:e,completedDate:e==="completed"?new Date().toLocaleDateString():null,userId:s})}catch(s){console.error("Error al mover la tarea:",s)}};let J=null,V=null,W=null;function it(){return document.body.id==="theme-dark"?"#F1F1F1":"#0f172a"}async function q(){J&&J.destroy(),V&&V.destroy(),W&&W.destroy();function n(u){const l=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*l,u.height=g.height*l;const v=u.getContext("2d");v.setTransform(1,0,0,1,0,0),v.scale(l,l)}if(y.value&&n(y.value),b.value&&n(b.value),h.value&&n(h.value),console.log("Chart.js disponible:",typeof I),console.log("lineChart element:",y.value),console.log("pieChart element:",b.value),console.log("monthlyChart element:",h.value),!y.value||!b.value||!h.value){console.error("Algunos elementos canvas no se encontraron");return}if(typeof I>"u"){console.error("Chart.js no está disponible");return}const e=new Date;e.setDate(e.getDate()-e.getDay()+1);const s=[0,0,0,0,0,0,0],o=[0,0,0,0,0,0,0],a=[0,0,0,0,0,0,0],m=[0,0,0,0,0,0,0];z.value.forEach(u=>{if(u.completedDate){const g=new Date(u.completedDate).getDay();g>=0&&g<7&&(s[g]++,console.log(`Tarea completada el día ${g}: ${u.title}`))}}),console.log("Tareas completadas:",z.value),console.log("Datos de tareas por día:",s);const _=await U(w(x,"transactions"));_.docs.forEach(u=>{const l=u.data(),v=new Date(l.date).getDay();v>=0&&v<7&&l.type==="expense"&&l.userId===f()&&(o[v]+=Number(l.amount)||0)}),(await U(w(x,"events"))).docs.forEach(u=>{const l=u.data(),v=new Date(l.date).getDay();v>=0&&v<7&&l.userId===f()&&a[v]++}),(await U(w(x,"meals"))).docs.forEach(u=>{const l=u.data(),v=new Date(l.date).getDay();v>=0&&v<7&&l.userId===f()&&(m[v]+=Number(l.calories)||0)});const i=it(),rt=[1200,1500,1100,1700,1600,1800,1400];J=new I(y.value,{type:"line",data:{labels:["Lun","Mar","Mié","Jue","Vie","Sáb","Dom"],datasets:[{label:"Balance Mensual",data:rt,fill:!0,backgroundColor:"rgba(99, 102, 241, 0.1)",borderColor:"#6366f1",pointBackgroundColor:"#6366f1",tension:.4,yAxisID:"y"},{label:"Gastos ($)",data:o,fill:!1,borderColor:"#06d6a0",pointBackgroundColor:"#06d6a0",tension:.4,yAxisID:"y1"},{label:"Eventos Agregados",data:a,fill:!1,borderColor:"#fbbf24",pointBackgroundColor:"#fbbf24",tension:.4,yAxisID:"y"}]},options:{plugins:{legend:{display:!0,labels:{usePointStyle:!0,padding:20,font:{size:16},color:i}}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Balance Mensual y Eventos",color:i,font:{size:16}},ticks:{color:i,font:{size:14}}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Gastos ($)",color:i,font:{size:16}},grid:{drawOnChartArea:!1},ticks:{color:i,font:{size:14}}},x:{ticks:{color:i,font:{size:14}}}},responsive:!0,maintainAspectRatio:!1}});const M={};_.docs.forEach(u=>{const l=u.data();l.type==="expense"&&l.category&&l.userId===f()&&(M[l.category]||(M[l.category]=0),M[l.category]+=Number(l.amount)||0)});const Q=Object.keys(M),X=Object.values(M);V=new I(b.value,{type:"doughnut",data:{labels:Q.length>0?Q:["Sin datos"],datasets:[{data:X.length>0?X:[1],backgroundColor:["#6366f1","#06d6a0","#fbbf24","#ef4444","#8b5cf6","#64748b","#10b981"]}]},options:{plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20,font:{size:16},color:i}}},cutout:"60%",responsive:!0,maintainAspectRatio:!1}});const ct=["Ene","Feb","Mar","Abr","May","Jun","Jul"],dt=[12,8,15,10,7,14,9],$={calories:[2200,2100,2500,2300,2e3,2400,2250],protein:[90,85,100,95,80,110,88],fat:[70,65,80,75,60,85,68],carbs:[300,280,320,310,270,330,295]};W=new I(h.value,{type:"bar",data:{labels:ct,datasets:[{label:"Tareas Completadas",data:dt,borderColor:"#6366f1",backgroundColor:"rgba(99, 102, 241, 0.5)",stack:"combined",type:"bar"},{label:"Calorías",data:$.calories,borderColor:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.3)",type:"line",yAxisID:"y1",fill:!1},{label:"Proteínas",data:$.protein,borderColor:"#06d6a0",backgroundColor:"rgba(6, 214, 160, 0.3)",type:"line",yAxisID:"y1",fill:!1},{label:"Grasas",data:$.fat,borderColor:"#fbbf24",backgroundColor:"rgba(251, 191, 36, 0.3)",type:"line",yAxisID:"y1",fill:!1},{label:"Carbohidratos",data:$.carbs,borderColor:"#8b5cf6",backgroundColor:"rgba(139, 92, 246, 0.3)",type:"line",yAxisID:"y1",fill:!1}]},options:{plugins:{legend:{display:!0,labels:{usePointStyle:!0,padding:20,font:{size:16},color:i}}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Tareas Completadas",color:i,font:{size:16}},ticks:{color:i,font:{size:14}}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Nutrientes",color:i,font:{size:16}},grid:{drawOnChartArea:!1},ticks:{color:i,font:{size:14}}},x:{ticks:{color:i,font:{size:14}}}},responsive:!0,maintainAspectRatio:!1}})}return S(async()=>{await vt();function n(s){const o=window.devicePixelRatio||1,a=s.getBoundingClientRect();s.width=a.width*o,s.height=a.height*o;const m=s.getContext("2d");m.setTransform(1,0,0,1,0,0),m.scale(o,o)}if(y.value&&n(y.value),b.value&&n(b.value),h.value&&n(h.value),console.log("Chart.js disponible:",typeof I),console.log("lineChart element:",y.value),console.log("pieChart element:",b.value),console.log("monthlyChart element:",h.value),!y.value||!b.value||!h.value){console.error("Algunos elementos canvas no se encontraron");return}if(typeof I>"u"){console.error("Chart.js no está disponible");return}await q(),new MutationObserver(()=>{q()}).observe(document.body,{attributes:!0,attributeFilter:["id"]})}),(n,e)=>(c(),d("section",yt,[t("div",ht,[e[26]||(e[26]=t("div",{class:"dashboard-header mb-4"},[t("h1",{class:"title is-size-2 text-primary"},"LifeSync Dashboard"),t("p",{class:"subtitle is-6 text-secondary"}," Gestiona tu tiempo, dinero y bienestar ")],-1)),t("div",ft,[(c(!0),d(C,null,k(lt.value,s=>(c(),d("div",{class:"column",key:s.title},[t("div",_t,[t("div",gt,[t("div",Dt,[t("div",null,[t("p",xt,r(s.value),1),t("p",Ct,r(s.title),1)]),t("span",kt,[t("i",{class:A(["bx",s.icon,"text-"+s.color,"is-size-2"])},null,2)])])])])]))),128))]),t("div",wt,[t("div",It,[t("div",Tt,[t("div",Et,[e[8]||(e[8]=t("h3",{class:"title is-6 mb-3"},"Actividad Semanal",-1)),t("div",Mt,[t("canvas",{ref_key:"lineChart",ref:y,id:"lineChart",style:{width:"100%",height:"260px"}},null,512)])])])]),t("div",St,[t("div",At,[t("div",zt,[e[9]||(e[9]=t("h3",{class:"title is-6 mb-3"},"Distribución de Gastos",-1)),t("div",$t,[t("canvas",{ref_key:"pieChart",ref:b,id:"pieChart",style:{width:"100%",height:"260px"}},null,512)])])])])]),t("div",Pt,[t("div",Bt,[t("div",Ft,[e[15]||(e[15]=t("div",{class:"card-header"},[t("h3",{class:"title is-5 mb-0"},"Gestión de Tareas")],-1)),t("div",Nt,[t("div",Rt,[t("div",{class:"task-column",onDragover:e[0]||(e[0]=K(()=>{},["prevent"])),onDrop:e[1]||(e[1]=s=>L(s,"todo"))},[e[11]||(e[11]=t("h4",{class:"title is-6 mb-3"},"Por Hacer",-1)),t("div",jt,[(c(!0),d(C,null,k(F.value,s=>(c(),d("div",{key:s.id,class:"task-item",draggable:"true",onDragstart:o=>G(o,s),onDragend:O},[t("div",Ot,[t("span",Lt,r(s.title),1),t("span",{class:A(["task-priority","priority-"+s.priority])},r(s.priority),3)]),t("button",{class:"btn btn-accent btn-sm",onClick:o=>Y(s.id,"progress")},e[10]||(e[10]=[t("i",{class:"bx bx-right-arrow-alt"},null,-1)]),8,Jt)],40,Gt))),128))])],32),t("div",{class:"task-column",onDragover:e[2]||(e[2]=K(()=>{},["prevent"])),onDrop:e[3]||(e[3]=s=>L(s,"progress"))},[e[13]||(e[13]=t("h4",{class:"title is-6 mb-3"},"En Progreso",-1)),t("div",Vt,[(c(!0),d(C,null,k(N.value,s=>(c(),d("div",{key:s.id,class:"task-item",draggable:"true",onDragstart:o=>G(o,s),onDragend:O},[t("div",Ht,[t("span",Kt,r(s.title),1),t("span",{class:A(["task-priority","priority-"+s.priority])},r(s.priority),3)]),t("button",{class:"btn btn-accent btn-sm",onClick:o=>Y(s.id,"completed")},e[12]||(e[12]=[t("i",{class:"bx bx-check"},null,-1)]),8,Ut)],40,Wt))),128))])],32),t("div",{class:"task-column",onDragover:e[4]||(e[4]=K(()=>{},["prevent"])),onDrop:e[5]||(e[5]=s=>L(s,"completed"))},[e[14]||(e[14]=t("h4",{class:"title is-6 mb-3"},"Completadas",-1)),t("div",Yt,[(c(!0),d(C,null,k(z.value,s=>(c(),d("div",{key:s.id,class:"task-item completed",draggable:"true",onDragstart:o=>G(o,s),onDragend:O},[t("div",Qt,[t("span",Xt,r(s.title),1),t("span",Zt,r(s.completedDate),1)])],40,qt))),128))])],32)])])])]),t("div",te,[t("div",ee,[e[17]||(e[17]=t("div",{class:"card-header"},[t("h3",{class:"title is-5 mb-0"},"Calendario")],-1)),t("div",se,[t("div",ae,[(c(!0),d(C,null,k(R.value,s=>(c(),d("div",{key:s.id,class:"event-item"},[t("div",oe,r(s.time),1),t("div",ne,[t("div",le,r(s.title),1),t("div",{class:A(["event-type","type-"+s.type])},r(s.type),3)])]))),128))]),t("button",{class:"btn btn-primary btn-sm mt-3 w-100",onClick:e[6]||(e[6]=s=>Z(B).push("/calendar"))},e[16]||(e[16]=[t("i",{class:"bx bx-plus mr-2"},null,-1),tt("Agregar Evento ")]))])])])]),t("div",ie,[t("div",re,[t("div",ce,[e[22]||(e[22]=t("div",{class:"card-header"},[t("h3",{class:"title is-5 mb-0"},"Wallet - Finanzas")],-1)),t("div",de,[t("div",ue,[t("div",pe,[t("div",ve,"$"+r(T.value.balance),1),e[18]||(e[18]=t("div",{class:"balance-label"},"Balance Actual",-1))]),t("div",me,[t("div",be,[t("div",ye," +$"+r(T.value.income),1),e[19]||(e[19]=t("div",{class:"stat-label"},"Ingresos",-1))]),t("div",he,[t("div",fe," -$"+r(T.value.expenses),1),e[20]||(e[20]=t("div",{class:"stat-label"},"Gastos",-1))])])]),t("div",_e,[e[21]||(e[21]=t("h4",{class:"title is-6 mb-3"},"Transacciones Recientes",-1)),(c(!0),d(C,null,k(T.value.recentTransactions,s=>(c(),d("div",{key:s.id,class:"transaction-item"},[t("div",ge,[t("div",De,r(s.title),1),t("div",xe,r(s.date),1)]),t("div",{class:A(["transaction-amount",s.type==="income"?"text-accent":"text-warning"])},r(s.type==="income"?"+":"-")+"$"+r(s.amount),3)]))),128))])])])]),t("div",Ce,[t("div",ke,[e[24]||(e[24]=t("div",{class:"card-header"},[t("h3",{class:"title is-5 mb-0"},"Planificación de Comidas")],-1)),t("div",we,[t("div",Ie,[(c(!0),d(C,null,k(j.value,s=>(c(),d("div",{class:"meal-day",key:s.day},[t("h4",Te,r(s.day),1),t("div",Ee,[(c(!0),d(C,null,k(s.meals,o=>(c(),d("div",{key:o.type,class:"meal-item"},[t("div",Me,r(o.type),1),t("div",Se,r(o.name),1),t("div",Ae,r(o.calories)+" cal",1)]))),128))])]))),128))]),t("button",{class:"btn btn-accent btn-sm mt-3 w-100",onClick:e[7]||(e[7]=s=>Z(B).push("/meals"))},e[23]||(e[23]=[t("i",{class:"bx bx-plus mr-2"},null,-1),tt("Planificar Comida ")]))])])])]),t("div",ze,[t("div",$e,[t("div",Pe,[t("div",Be,[e[25]||(e[25]=t("h3",{class:"title is-6 mb-3"}," Resumen Mensual: Tareas y Nutrientes ",-1)),t("div",Fe,[t("canvas",{ref_key:"monthlyChart",ref:h,id:"monthlyChart",style:{width:"100%",height:"320px"}},null,512)])])])])])])]))}},Re=ot(Ne,[["__scopeId","data-v-d4941752"]]);const je={class:"dashboard-page"},Ge={__name:"Dashboard",setup(nt){return(B,E)=>(c(),d("div",je,[et(bt,{viewType:"dashboard"}),et(Re)]))}},Ke=ot(Ge,[["__scopeId","data-v-e9622ffd"]]);export{Ke as default};

import{a as p,d as w,_ as T}from"./index-912f96f0.js";import{r as g,s as V,j as N,v as G,x as z,y as o,z as u,A as b,B as v,C as M}from"./vendor-a1a62974.js";import{G as W,s as q,t as _,u as j,w as O,x as E,y as X,z as h,A as P,B as J,D as K}from"./firebase-1b009ed5.js";import{a as d,b as f}from"./alert-015a1aea.js";import{F as Q}from"./FloatingIcons-e36b23d3.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import"./sweetalert2.esm.all-9d2ad45a.js";const Z={class:"login-page"},ee={class:"form-box login"},oe={class:"input-box"},te={class:"input-box"},se={class:"forgot-link"},re={class:"social-icons"},ie=["innerHTML"],ae={class:"form-box register"},ne={class:"input-box"},le={class:"input-box"},de={class:"input-box"},ue={class:"social-icons"},ce={__name:"Login",setup(me,{expose:C}){const R=new W;new q;const U=new _,I=async(t,e)=>{var a;console.log("=== MANEJANDO CUENTA EXISTENTE CON DIFERENTE CREDENCIAL ==="),console.log("Error:",t),console.log("Proveedor:",e);const s=(a=t.customData)==null?void 0:a.email;if(!s){d("No se pudo obtener el correo electrónico del error");return}try{const r=await K(p,s);console.log("Métodos disponibles para",s,":",r);let n="",i="";r.includes("password")?(n=`El correo ${s} ya está registrado con email y contraseña.`,i="Por favor, inicia sesión usando tu correo y contraseña en la sección de Login."):r.includes("google.com")?(n=`El correo ${s} ya está registrado con Google.`,i="Por favor, inicia sesión usando el botón de Google."):r.includes("github.com")?(n=`El correo ${s} ya está registrado con GitHub.`,i="Por favor, inicia sesión usando el botón de GitHub."):r.includes("facebook.com")?(n=`El correo ${s} ya está registrado con Facebook.`,i="Por favor, inicia sesión usando el botón de Facebook."):(n=`El correo ${s} ya está registrado con otro método.`,i="Por favor, inicia sesión usando el método original con el que te registraste."),d(`${n}

${i}`),e==="GitHub"&&r.includes("google.com")&&console.log("Sugiriendo usar Google en lugar de GitHub")}catch(r){console.error("Error al verificar métodos de inicio de sesión:",r),d("Error al verificar los métodos de inicio de sesión disponibles")}};g("");const c=g("");C({modalContent:c});const D=()=>{console.log("Abriendo modal de recuperación"),c.value=`
    <div style="z-index:9999999; background:rgba(0,0,0,0.8); position:fixed; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center;">
      <div style="background:#fff; border:5px solid #f00; color:#000; z-index:10000001; padding:2rem; border-radius:10px; width:90%; max-width:400px; box-shadow:0 2px 10px rgba(0,0,0,0.3); text-align:center;">
        <h3>Recuperar contraseña</h3>
        <div style='color:red; font-weight:bold;'></div>
        <div style='margin-top:1rem; margin-bottom:0.5rem;'>
          <input id='resetEmailInput' type='email' placeholder='Correo electrónico' autocomplete='email' style='border: 4px solid green; background: #fff200; color: #222; font-size:22px; padding:20px; width:100%;' />
        </div>
        <div style='margin-top:1rem; display:flex; justify-content:space-around;'>
          <button id='enviarBtn' style='background:#00c853; color:#fff; font-size:20px; border:3px solid #222; padding:8px 16px;'>Enviar</button>
          <button id='cancelarBtn' style='background:#d50000; color:#fff; font-size:20px; border:3px solid #222; padding:8px 16px;'>Cancelar</button>
        </div>
      </div>
    </div>
  `,setTimeout(()=>{document.getElementById("cancelarBtn").onclick=()=>{c.value=""},document.getElementById("enviarBtn").onclick=()=>{const t=document.getElementById("resetEmailInput").value;A(t)}},0)},A=async t=>{if(!t){d("Por favor, ingresa tu correo.");return}try{await j(p,t),f("Correo de recuperación enviado."),c.value=""}catch(e){console.error("Error al enviar el correo:",e),d("Hubo un error. Verifica el correo o intenta más tarde.")}},x=V(),y=g(null),m=g({username:"",password:""}),l=g({username:"",email:"",password:""}),B=()=>{y.value.classList.add("active")},F=()=>{y.value.classList.remove("active")},H=async()=>{try{const t=m.value.username,e=m.value.password,s=await O(p,t,e);localStorage.setItem("isLoggedIn","true"),localStorage.setItem("uid",s.user.uid);let a=t;const r=E(w,"users",s.user.uid),n=await T(()=>import("./firebase-1b009ed5.js").then(i=>i.X),[]).then(({getDoc:i})=>i(r));if(n&&n.exists()){const i=n.data();i.name&&(a=i.name)}f(`Bienvenido ${a}`),x.push("/dashboard")}catch{d("Error al iniciar sesión: ")}},$=async()=>{try{const t=l.value.email,e=l.value.password,s=l.value.username,a=await X(p,t,e);await h(E(w,"users",a.user.uid),{name:s,email:t,username:"",bio:"",photo:""}),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("uid",a.user.uid),x.push("/dashboard"),f(`bienvenido ${s}`)}catch{d("Error al registrarse")}},k=async()=>{try{console.log("Google clicked");const t=await P(p,R),e=t.user;await S(e),console.log("Login exitoso con Google",t.user),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("uid",t.user.uid),localStorage.setItem("displayName",e.displayName||""),localStorage.setItem("email",e.email||""),localStorage.setItem("photoURL",e.photoURL||""),f(`Bienvenido ${t.user.displayName||"Usuario"}`),x.push("/dashboard")}catch(t){console.error("Error con Google:",t),t.code==="auth/account-exists-with-different-credential"?await I(t,"Google"):d("Error al iniciar sesión con Google")}},L=async()=>{try{const t=await P(p,U),e=t.user;await S(e),console.log("Login exitoso con GitHub",t.user),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("uid",t.user.uid),localStorage.setItem("displayName",e.displayName||""),localStorage.setItem("email",e.email||""),localStorage.setItem("photoURL",e.photoURL||""),f(`Bienvenido ${t.user.displayName||"Usuario"}`),x.push("/dashboard")}catch(t){console.error("Error con GitHub:",t),t.code==="auth/account-exists-with-different-credential"?await I(t,"GitHub"):d("Error al iniciar sesión con GitHub")}};async function S(t){var a;const e=E(w,"users",t.uid),s=await J(e);if(!s.exists())await h(e,{name:t.displayName||"Sin nombre",email:t.email||"Sin correo",bio:"",photo:t.photoURL||"",provider:((a=t.providerData[0])==null?void 0:a.providerId)||"manual",createdAt:new Date}),console.log(" Usuario registrado en Firestore");else{const r=s.data();r.name==="Sin nombre"&&t.displayName&&t.displayName!=="Sin nombre"&&(await h(e,{...r,name:t.displayName},{merge:!0}),console.log(" Nombre actualizado en Firestore"))}}return(t,e)=>(N(),G("div",Z,[z(Q,{viewType:"login"}),o("div",{class:"container",ref_key:"container",ref:y},[o("div",ee,[o("form",{onSubmit:u(H,["prevent"])},[e[9]||(e[9]=o("h1",null,"Login",-1)),o("div",oe,[b(o("input",{type:"text",placeholder:"Username",required:"","onUpdate:modelValue":e[0]||(e[0]=s=>m.value.username=s)},null,512),[[v,m.value.username]]),e[5]||(e[5]=o("i",{class:"bx bxs-user"},null,-1))]),o("div",te,[b(o("input",{type:"password",placeholder:"Password",required:"","onUpdate:modelValue":e[1]||(e[1]=s=>m.value.password=s)},null,512),[[v,m.value.password]]),e[6]||(e[6]=o("i",{class:"bx bxs-lock-alt"},null,-1))]),o("div",se,[o("a",{href:"#",onClick:u(D,["prevent"])},"Forgot Password?")]),e[10]||(e[10]=o("button",{type:"submit",class:"btn"},"Login",-1)),e[11]||(e[11]=o("p",null,"or login with social platforms",-1)),o("div",re,[o("a",{onClick:u(k,["prevent"])},e[7]||(e[7]=[o("i",{class:"bx bxl-google"},null,-1)])),o("a",{onClick:u(L,["prevent"])},e[8]||(e[8]=[o("i",{class:"bx bxl-github"},null,-1)]))])],32)]),c.value?(N(),G("div",{key:0,innerHTML:c.value},null,8,ie)):M("",!0),o("div",ae,[o("form",{onSubmit:u($,["prevent"])},[e[17]||(e[17]=o("h1",null,"Registration",-1)),o("div",ne,[b(o("input",{type:"text",placeholder:"Username",required:"","onUpdate:modelValue":e[2]||(e[2]=s=>l.value.username=s)},null,512),[[v,l.value.username]]),e[12]||(e[12]=o("i",{class:"bx bxs-user"},null,-1))]),o("div",le,[b(o("input",{type:"email",placeholder:"Email",required:"","onUpdate:modelValue":e[3]||(e[3]=s=>l.value.email=s)},null,512),[[v,l.value.email]]),e[13]||(e[13]=o("i",{class:"bx bxs-envelope"},null,-1))]),o("div",de,[b(o("input",{type:"password",placeholder:"Password",required:"","onUpdate:modelValue":e[4]||(e[4]=s=>l.value.password=s)},null,512),[[v,l.value.password]]),e[14]||(e[14]=o("i",{class:"bx bxs-lock-alt"},null,-1))]),e[18]||(e[18]=o("button",{type:"submit",class:"btn"},"Register",-1)),e[19]||(e[19]=o("p",null,"or register with social platforms",-1)),o("div",ue,[o("a",{onClick:u(k,["prevent"])},e[15]||(e[15]=[o("i",{class:"bx bxl-google"},null,-1)])),o("a",{onClick:u(L,["prevent"])},e[16]||(e[16]=[o("i",{class:"bx bxl-github"},null,-1)]))])],32)]),o("div",{class:"toggle-box"},[o("div",{class:"toggle-panel toggle-left"},[e[20]||(e[20]=o("h1",null,"Hello, Welcome to",-1)),e[21]||(e[21]=o("h1",null,"LifeSync!",-1)),e[22]||(e[22]=o("p",null,"Don't have an account?",-1)),o("button",{class:"btn register-btn",onClick:B}," Register ")]),o("div",{class:"toggle-panel toggle-right"},[e[23]||(e[23]=o("h1",null,"Welcome Back!",-1)),e[24]||(e[24]=o("p",null,"Already have an account?",-1)),o("button",{class:"btn login-btn",onClick:F},"Login")])])],512)]))}},we=Y(ce,[["__scopeId","data-v-87ae7e3d"]]);export{we as default};

import{j as a,v as i,y as e,E as z,C as U,I as m,r as k,J as Ie,K as G,F as w,G as K,s as Ee,a as Ne,x as J,k as xe,H as ee,T as ue,Q as ce,n as Ae,z as R,A as V,B as L,S as Se}from"./vendor-a1a62974.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";import{a as C,d as b}from"./index-912f96f0.js";import{H as j,q as N,J as E,K as ie,x as P,B as le,p as te,M as se,N as ne,O as de,P as ve,I as Pe}from"./firebase-1b009ed5.js";import qe from"./UserProfile-3168adea.js";import Me from"./Chat-75e264c3.js";import"./sweetalert2.esm.all-9d2ad45a.js";import"./FloatingIcons-e36b23d3.js";const Fe={class:"sidebar-header"},Te={key:0},Ve={key:1},je={class:"sidebar-nav"},Oe={key:0},Qe={key:0},Ge={key:0},ze={key:1,class:"pending-badge"},Le={class:"user-profile"},Be={class:"avatar"},He=["src"],Je={class:"user-info"},Ke={class:"user-name"},We={class:"user-email"},Xe={__name:"SidebarFeed",props:{user:{type:Object,required:!0},isSidebarCollapsed:{type:Boolean,default:!1},activeSection:{type:String,default:"feed"},pendingRequestsCount:{type:Number,default:0}},setup(I){return(l,f)=>(a(),i("aside",{class:z(["feed-sidebar",{collapsed:I.isSidebarCollapsed}])},[e("div",Fe,[I.isSidebarCollapsed?(a(),i("span",Ve,"CM")):(a(),i("h2",Te,"Comunidad")),e("button",{class:"toggle-btn",onClick:f[0]||(f[0]=D=>l.$emit("toggle-sidebar"))},[e("i",{class:z(["bx",I.isSidebarCollapsed?"bx-menu":"bx-menu-alt-left"])},null,2)])]),e("nav",je,[f[7]||(f[7]=e("div",{class:"nav-section"},"MENÚ",-1)),e("div",{class:z(["nav-item",{active:I.activeSection==="feed"}]),onClick:f[1]||(f[1]=D=>l.$emit("update:activeSection","feed"))},[f[4]||(f[4]=e("i",{class:"bx bx-group"},null,-1)),I.isSidebarCollapsed?U("",!0):(a(),i("span",Oe,"Comunidad"))],2),e("div",{class:z(["nav-item",{active:I.activeSection==="chat"}]),onClick:f[2]||(f[2]=D=>l.$emit("update:activeSection","chat"))},[f[5]||(f[5]=e("i",{class:"bx bx-chat"},null,-1)),I.isSidebarCollapsed?U("",!0):(a(),i("span",Qe,"Chats"))],2),e("div",{class:z(["nav-item",{active:I.activeSection==="friends"}]),onClick:f[3]||(f[3]=D=>l.$emit("update:activeSection","friends"))},[f[6]||(f[6]=e("i",{class:"bx bx-user-check"},null,-1)),I.isSidebarCollapsed?U("",!0):(a(),i("span",Ge,"Amigos")),!I.isSidebarCollapsed&&I.pendingRequestsCount>0?(a(),i("span",ze,m(I.pendingRequestsCount),1)):U("",!0)],2)]),e("div",Le,[e("div",Be,[e("img",{src:I.user.avatar,alt:"avatar"},null,8,He)]),e("div",Je,[e("div",Ke,m(I.user.name),1),e("div",We,m(I.user.email||""),1)])])],2))}},Ye=me(Xe,[["__scopeId","data-v-b799b7a6"]]);const Ze={class:"friends-container"},es={class:"friends-header"},ss={class:"friends-nav"},ts={key:0,class:"badge"},ns={key:0,class:"badge"},os={key:0,class:"badge"},as={class:"friends-stats"},is={class:"stat-card"},ls={class:"stat-info"},ds={class:"stat-number"},rs={class:"stat-card"},us={class:"stat-info"},cs={class:"stat-number"},vs={class:"stat-card"},ms={class:"stat-info"},fs={class:"stat-number"},ps={class:"friends-content"},bs={key:0,class:"section-content"},gs={key:0,class:"empty-state"},_s={key:1,class:"requests-grid"},ys={class:"request-avatar"},hs=["src","alt"],Cs={class:"request-info"},ks={class:"request-actions"},Us=["onClick"],$s=["onClick"],xs={key:1,class:"section-content"},Ss={key:0,class:"empty-state"},Is={key:1,class:"requests-grid"},Rs={class:"request-avatar"},ws=["src","alt"],Ds={class:"request-info"},Es={class:"request-actions"},Ns=["onClick"],As={key:2,class:"section-content"},Ps={key:0,class:"empty-state"},qs={key:1,class:"friends-grid"},Ms={class:"friend-avatar"},Fs=["src","alt"],Ts={class:"friend-info"},Vs={class:"friend-actions"},js=["onClick"],Os=["onClick"],Qs={__name:"Friends",setup(I){const l=k([]),f=k([]),D=k([]),A=k("pending");async function O(){var v;if((v=C.currentUser)!=null&&v.uid){console.log("=== CARGANDO AMIGOS EN FRIENDS.VUE ==="),console.log("Usuario actual:",C.currentUser.uid);try{const n=j(N(b,"friendships"),E("userId","==",C.currentUser.uid)),r=await ie(n);console.log("Friendships donde soy userId:",r.docs.length);const h=j(N(b,"friendships"),E("friendId","==",C.currentUser.uid)),$=await ie(h);console.log("Friendships donde soy friendId:",$.docs.length);const u=[],x=new Set;for(const q of r.docs){const _=q.data();if(console.log("Friendship 1:",_),!x.has(_.friendId))try{const Q=P(b,"users",_.friendId),H=await le(Q);if(H.exists()){const T=H.data();console.log("Datos del amigo 1:",T),u.push({id:q.id,uid:_.friendId,name:T.name||"Usuario",email:T.email||"",photo:T.photo||"",friendshipDate:_.createdAt}),x.add(_.friendId)}else console.log("No se encontró el usuario con ID:",_.friendId)}catch(Q){console.error("Error obteniendo datos del amigo 1:",Q)}}for(const q of $.docs){const _=q.data();if(console.log("Friendship 2:",_),!x.has(_.userId))try{const Q=P(b,"users",_.userId),H=await le(Q);if(H.exists()){const T=H.data();console.log("Datos del amigo 2:",T),u.push({id:q.id,uid:_.userId,name:T.name||"Usuario",email:T.email||"",photo:T.photo||"",friendshipDate:_.createdAt}),x.add(_.userId)}else console.log("No se encontró el usuario con ID:",_.userId)}catch(Q){console.error("Error obteniendo datos del amigo 2:",Q)}}l.value=u,console.log("Amigos cargados:",u),console.log("Total de amigos únicos:",u.length)}catch(n){console.error("Error cargando amigos:",n)}}}async function c(){var v;if((v=C.currentUser)!=null&&v.uid){console.log("=== CARGANDO SOLICITUDES PENDIENTES ==="),console.log("Usuario actual:",C.currentUser.uid);try{const n=j(N(b,"friend_requests"),E("toUserId","==",C.currentUser.uid),E("status","==","pending")),r=await ie(n);console.log("Solicitudes pendientes encontradas:",r.docs.length);const h=[];r.forEach($=>{const u=$.data();console.log("Solicitud pendiente:",u),h.push({id:$.id,fromUserId:u.fromUserId,fromUserName:u.fromUserName||"Usuario",fromUserEmail:u.fromUserEmail||"",fromUserPhoto:u.fromUserPhoto||"",createdAt:u.createdAt})}),f.value=h,console.log("Solicitudes pendientes cargadas:",h)}catch(n){console.error("Error cargando solicitudes pendientes:",n)}}}async function B(){var v;if((v=C.currentUser)!=null&&v.uid){console.log("=== CARGANDO SOLICITUDES ENVIADAS ==="),console.log("Usuario actual:",C.currentUser.uid);try{const n=j(N(b,"friend_requests"),E("fromUserId","==",C.currentUser.uid),E("status","==","pending")),r=await ie(n);console.log("Solicitudes enviadas encontradas:",r.docs.length);const h=[];for(const $ of r.docs){const u=$.data();console.log("Solicitud enviada:",u);try{const x=P(b,"users",u.toUserId),q=await le(x);if(q.exists()){const _=q.data();console.log("Datos del usuario que recibió la solicitud:",_),h.push({id:$.id,toUserId:u.toUserId,toUserName:_.name||"Usuario",toUserEmail:_.email||"",toUserPhoto:_.photo||"",createdAt:u.createdAt})}else console.log("No se encontró el usuario con ID:",u.toUserId)}catch(x){console.error("Error obteniendo datos del usuario:",x)}}D.value=h,console.log("Solicitudes enviadas cargadas:",h)}catch(n){console.error("Error cargando solicitudes enviadas:",n)}}}function M(){var $;if(!(($=C.currentUser)!=null&&$.uid))return;console.log("=== CONFIGURANDO LISTENERS EN FRIENDS.VUE ===");const v=j(N(b,"friendships"),E("userId","==",C.currentUser.uid)),n=j(N(b,"friendships"),E("friendId","==",C.currentUser.uid));te(v,u=>{console.log("Cambio detectado en friendships (userId):",u.docChanges().length),O()}),te(n,u=>{console.log("Cambio detectado en friendships (friendId):",u.docChanges().length),O()});const r=j(N(b,"friend_requests"),E("toUserId","==",C.currentUser.uid),E("status","==","pending"));te(r,u=>{console.log("Cambio detectado en solicitudes pendientes:",u.docChanges().length),c()});const h=j(N(b,"friend_requests"),E("fromUserId","==",C.currentUser.uid),E("status","==","pending"));te(h,u=>{console.log("Cambio detectado en solicitudes enviadas:",u.docChanges().length),B()})}async function W(v){try{console.log("=== ACEPTANDO SOLICITUD DESDE FRIENDS ==="),console.log("Solicitud:",v),console.log("Usuario actual:",C.currentUser.uid),await se(P(b,"friend_requests",v.id),{status:"accepted",updatedAt:ne()}),await de(N(b,"friendships"),{userId:C.currentUser.uid,friendId:v.fromUserId,createdAt:ne()}),await de(N(b,"friendships"),{userId:v.fromUserId,friendId:C.currentUser.uid,createdAt:ne()}),await de(N(b,"notifications"),{toUserId:v.fromUserId,fromUserId:C.currentUser.uid,type:"friend_request_accepted",title:"Solicitud de amistad aceptada",message:`${C.currentUser.displayName||"Alguien"} aceptó tu solicitud de amistad`,read:!1,createdAt:ne()}),console.log("Solicitud aceptada correctamente desde Friends")}catch(n){console.error("Error aceptando solicitud:",n)}}async function F(v){try{await ve(P(b,"friend_requests",v.id))}catch(n){console.error("Error rechazando solicitud:",n)}}async function Y(v){try{await ve(P(b,"friend_requests",v.id))}catch(n){console.error("Error cancelando solicitud:",n)}}function oe(v){console.log("Abrir perfil de:",v)}function Z(v){console.log("Enviar mensaje a:",v.name)}function X(v){if(!v)return"";const n=v.toDate?v.toDate():new Date(v),h=new Date-n,$=Math.floor(h/6e4),u=Math.floor(h/36e5),x=Math.floor(h/864e5);return $<1?"Ahora":$<60?`Hace ${$} min`:u<24?`Hace ${u} h`:x<7?`Hace ${x} días`:n.toLocaleDateString()}function ae(v){v.target.src="https://ui-avatars.com/api/?name=U&size=64"}return Ie(()=>{O(),c(),B(),M()}),(v,n)=>(a(),i("div",Ze,[e("div",es,[n[9]||(n[9]=e("h2",null,"Mis Amigos",-1)),e("div",ss,[e("button",{class:z(["nav-btn",{active:A.value==="pending"}]),onClick:n[0]||(n[0]=r=>A.value="pending")},[n[3]||(n[3]=e("i",{class:"bx bx-user-plus"},null,-1)),n[4]||(n[4]=G(" Solicitudes Pendientes ")),f.value.length>0?(a(),i("span",ts,m(f.value.length),1)):U("",!0)],2),e("button",{class:z(["nav-btn",{active:A.value==="sent"}]),onClick:n[1]||(n[1]=r=>A.value="sent")},[n[5]||(n[5]=e("i",{class:"bx bx-send"},null,-1)),n[6]||(n[6]=G(" Solicitudes Enviadas ")),D.value.length>0?(a(),i("span",ns,m(D.value.length),1)):U("",!0)],2),e("button",{class:z(["nav-btn",{active:A.value==="friends"}]),onClick:n[2]||(n[2]=r=>A.value="friends")},[n[7]||(n[7]=e("i",{class:"bx bx-user-check"},null,-1)),n[8]||(n[8]=G(" Mis Amigos ")),l.value.length>0?(a(),i("span",os,m(l.value.length),1)):U("",!0)],2)])]),e("div",as,[e("div",is,[n[11]||(n[11]=e("i",{class:"bx bx-user-plus"},null,-1)),e("div",ls,[e("span",ds,m(f.value.length),1),n[10]||(n[10]=e("span",{class:"stat-label"},"Pendientes",-1))])]),e("div",rs,[n[13]||(n[13]=e("i",{class:"bx bx-send"},null,-1)),e("div",us,[e("span",cs,m(D.value.length),1),n[12]||(n[12]=e("span",{class:"stat-label"},"Enviadas",-1))])]),e("div",vs,[n[15]||(n[15]=e("i",{class:"bx bx-user-check"},null,-1)),e("div",ms,[e("span",fs,m(l.value.length),1),n[14]||(n[14]=e("span",{class:"stat-label"},"Amigos",-1))])])]),e("div",ps,[A.value==="pending"?(a(),i("div",bs,[n[19]||(n[19]=e("h3",null,"Solicitudes Pendientes",-1)),f.value.length===0?(a(),i("div",gs,n[16]||(n[16]=[e("i",{class:"bx bx-user-plus"},null,-1),e("p",null,"No tienes solicitudes pendientes",-1)]))):(a(),i("div",_s,[(a(!0),i(w,null,K(f.value,r=>(a(),i("div",{key:r.id,class:"request-card"},[e("div",ys,[e("img",{src:r.fromUserPhoto||`https://ui-avatars.com/api/?name=${encodeURIComponent(r.fromUserName||"U")}&size=64`,alt:r.fromUserName,onError:ae},null,40,hs)]),e("div",Cs,[e("h4",null,m(r.fromUserName),1),e("p",null,m(r.fromUserEmail),1),e("small",null,m(X(r.createdAt)),1)]),e("div",ks,[e("button",{class:"btn-accept",onClick:h=>W(r)},n[17]||(n[17]=[e("i",{class:"bx bx-check"},null,-1),G(" Aceptar ")]),8,Us),e("button",{class:"btn-reject",onClick:h=>F(r)},n[18]||(n[18]=[e("i",{class:"bx bx-x"},null,-1),G(" Rechazar ")]),8,$s)])]))),128))]))])):U("",!0),A.value==="sent"?(a(),i("div",xs,[n[22]||(n[22]=e("h3",null,"Solicitudes Enviadas",-1)),D.value.length===0?(a(),i("div",Ss,n[20]||(n[20]=[e("i",{class:"bx bx-send"},null,-1),e("p",null,"No has enviado solicitudes",-1)]))):(a(),i("div",Is,[(a(!0),i(w,null,K(D.value,r=>(a(),i("div",{key:r.id,class:"request-card"},[e("div",Rs,[e("img",{src:r.toUserPhoto||`https://ui-avatars.com/api/?name=${encodeURIComponent(r.toUserName||"U")}&size=64`,alt:r.toUserName,onError:ae},null,40,ws)]),e("div",Ds,[e("h4",null,m(r.toUserName),1),e("p",null,m(r.toUserEmail),1),e("small",null,m(X(r.createdAt)),1)]),e("div",Es,[e("button",{class:"btn-cancel",onClick:h=>Y(r)},n[21]||(n[21]=[e("i",{class:"bx bx-x"},null,-1),G(" Cancelar ")]),8,Ns)])]))),128))]))])):U("",!0),A.value==="friends"?(a(),i("div",As,[n[26]||(n[26]=e("h3",null,"Mis Amigos",-1)),l.value.length===0?(a(),i("div",Ps,n[23]||(n[23]=[e("i",{class:"bx bx-user-check"},null,-1),e("p",null,"No tienes amigos aún",-1),e("p",{class:"empty-hint"},"¡Agrega amigos desde el feed!",-1)]))):(a(),i("div",qs,[(a(!0),i(w,null,K(l.value,r=>(a(),i("div",{key:r.id,class:"friend-card"},[e("div",Ms,[e("img",{src:r.photo||`https://ui-avatars.com/api/?name=${encodeURIComponent(r.name||"U")}&size=64`,alt:r.name,onError:ae},null,40,Fs)]),e("div",Ts,[e("h4",null,m(r.name),1),e("p",null,m(r.email),1),e("small",null,"Amigos desde "+m(X(r.friendshipDate)),1)]),e("div",Vs,[e("button",{class:"btn-profile",onClick:h=>oe(r.uid)},n[24]||(n[24]=[e("i",{class:"bx bx-user"},null,-1),G(" Ver Perfil ")]),8,js),e("button",{class:"btn-message",onClick:h=>Z(r)},n[25]||(n[25]=[e("i",{class:"bx bx-message"},null,-1),G(" Mensaje ")]),8,Os)])]))),128))]))])):U("",!0)])]))}},Gs=me(Qs,[["__scopeId","data-v-959d229a"]]);const zs={class:"feed-layout"},Ls={class:"feed-main"},Bs={class:"feed-header"},Hs={class:"modal-feed-content"},Js={key:0,class:"modal is-active"},Ks={class:"modal-card"},Ws={class:"modal-card-body"},Xs={class:"field"},Ys={class:"control"},Zs={class:"field"},et={class:"control"},st={class:"field"},tt={class:"control"},nt={class:"field"},ot={class:"control"},at={class:"radio"},it={class:"radio"},lt={class:"post-header"},dt=["src","onClick"],rt={class:"post-user-info"},ut={class:"post-user"},ct={class:"post-date"},vt={key:0,class:"post-actions-right"},mt=["onClick"],ft=["onClick"],pt=["onClick"],bt={class:"edit-actions"},gt=["onClick"],_t=["src"],yt={class:"post-actions"},ht=["onClick"],Ct=["aria-label"],kt={key:0},Ut=["src","onClick"],$t={class:"comment-body"},xt={class:"edit-actions"},St=["onClick"],It={class:"comment-user"},Rt={class:"comment-text"},wt={key:0,class:"comment-actions"},Dt=["onClick"],Et=["onClick"],Nt=["onSubmit"],At=["onUpdate:modelValue"],Pt={class:"modal-feed-content"},qt={class:"post-header"},Mt=["src"],Ft={class:"post-user-info"},Tt={class:"post-user"},Vt={class:"post-date"},jt={key:0,class:"post-actions-right"},Ot={class:"post-content"},Qt={class:"edit-actions"},Gt=["src"],zt={class:"post-actions"},Lt=["onClick"],Bt=["aria-label"],Ht={key:0},Jt=["src"],Kt={class:"comment-body"},Wt={class:"edit-actions"},Xt=["onClick"],Yt={class:"comment-user"},Zt={class:"comment-text"},en={key:0,class:"comment-actions"},sn=["onClick"],tn=["onClick"],nn={__name:"Feed",setup(I){Ee();const l=k({name:"Usuario",avatar:"https://ui-avatars.com/api/?name=Usuario&background=6366f1&color=fff",uid:null}),f=k([]),D=k("");k(null);const A=k(""),O=Ne({}),c=k(null),B=k(null),M=k(""),W=k(null),F=k(""),Y=k(""),oe=k(!1),Z=k("feed"),X=k(0);function ae(){oe.value=!oe.value}async function v(){if(l.value.uid)try{const d=j(N(b,"friend_requests"),E("toUserId","==",l.value.uid),E("status","==","pending")),s=await ie(d);X.value=s.size}catch(d){console.error("Error cargando solicitudes pendientes:",d)}}function n(){if(!l.value.uid)return;const d=j(N(b,"friend_requests"),E("toUserId","==",l.value.uid),E("status","==","pending"));te(d,s=>{X.value=s.size})}const r=async(d,s,t)=>{if(!(!s||!s.user||!t)&&s.user.uid!==t.uid)try{let o="",y="",g="feed_update";switch(d){case"comment":o="Nuevo comentario",y=`${t.name} comentó en tu publicación "${s.title}"`,g="feed_comment";break;case"reaction":o="Nueva reacción",y=`${t.name} reaccionó a tu publicación "${s.title}"`,g="feed_reaction";break;default:return}const p={toUserId:s.user.uid,fromUserId:t.uid,fromUserName:t.name,fromUserPhoto:t.avatar,type:g,title:o,message:y,postId:s.id,postTitle:s.title,read:!1,createdAt:ne()};await de(N(b,"notifications"),p)}catch(o){console.error("Error enviando notificación de feed:",o)}},h=[{type:"like",emoji:"👍",label:"Me gusta"},{type:"love",emoji:"❤️",label:"Me encanta"},{type:"laugh",emoji:"😂",label:"Me divierte"},{type:"wow",emoji:"😮",label:"Me asombra"},{type:"sad",emoji:"😢",label:"Me entristece"},{type:"angry",emoji:"😡",label:"Me enoja"}],$=k(!1),u=k(""),x=k("public");function q(){$.value=!1,u.value="",D.value="",A.value="",x.value="public"}const _=k(null);function Q(d){_.value=d}function H(){_.value=null}Ie(async()=>{const d=C.currentUser;let s="",t="",o="";if(d){if(o=d.uid,s=d.displayName||"",t=d.photoURL||"",!s){const g=await le(P(b,"users",o));if(g.exists()){const p=g.data();s=p.name||"",t=p.photo||""}}l.value.name=s||"Usuario",l.value.avatar=t||`https://ui-avatars.com/api/?name=${encodeURIComponent(l.value.name)}&background=6366f1&color=fff`,l.value.uid=o}else C.onAuthStateChanged(async g=>{if(g){if(o=g.uid,s=g.displayName||"",t=g.photoURL||"",!s){const p=await le(P(b,"users",o));if(p.exists()){const S=p.data();s=S.name||"",t=S.photo||""}}l.value.name=s||"Usuario",l.value.avatar=t||`https://ui-avatars.com/api/?name=${encodeURIComponent(l.value.name)}&background=6366f1&color=fff`,l.value.uid=o}});const y=j(N(b,"feed_posts"),Pe("createdAt","desc"));te(y,g=>{f.value.map(p=>({...p})),f.value=g.docs.map(p=>{const S=p.data();return S.user.avatar||(S.user.avatar=`https://ui-avatars.com/api/?name=${encodeURIComponent(S.user.name)}&background=6366f1&color=fff`),{id:p.id,...S,comments:S.comments||[],reactions:S.reactions||{},userReaction:S.userReactions&&l.value.uid?S.userReactions[l.value.uid]:null}}),Ae(()=>{f.value.forEach(p=>{p.user&&(p.user.uid,l.value.uid)})})}),v(),n()});async function T(){!l.value.name||l.value.name==="Usuario"||!u.value.trim()||!D.value.trim()||(await de(N(b,"feed_posts"),{user:{name:l.value.name,avatar:l.value.avatar,uid:l.value.uid},title:u.value,content:D.value,image:A.value,visibility:x.value,createdAt:ne(),comments:[],reactions:{},userReactions:{}}),q())}async function Re(d,s,t=!1){const o=f.value.find($e=>$e&&$e.id===d);if(!o||!l.value.uid)return;const y=P(b,"feed_posts",d),g=o.userReactions&&o.userReactions[l.value.uid];let p={...o.reactions},S={...o.userReactions};g&&g!==s&&p[g]&&(p[g]--,p[g]===0&&delete p[g]),g===s?(p[s]&&(p[s]--,p[s]===0&&delete p[s]),delete S[l.value.uid]):(p[s]||(p[s]=0),p[s]++,S[l.value.uid]=s,await r("reaction",o,l.value)),await se(y,{reactions:p,userReactions:S})}async function fe(d,s=!1){const t=O[d];if(!t||!t.trim())return;const o=P(b,"feed_posts",d),y=f.value.find(S=>S&&S.id===d);if(!y)return;const g={id:Date.now(),user:l.value.name,avatar:l.value.avatar,text:t,uid:l.value.uid,createdAt:new Date().toISOString()},p=[...y.comments||[],g];await se(o,{comments:p}),await r("comment",y,l.value),O[d]=""}function we(d){c.value=JSON.parse(JSON.stringify(d))}function re(){c.value=null}function pe(d,s=!1){B.value=d.id,M.value=d.content}function be(){B.value=null,M.value=""}async function ge(d,s=!1){if(!M.value.trim())return;const t=P(b,"feed_posts",d.id);await se(t,{content:M.value}),B.value=null,M.value="",s&&c.value&&(c.value.content=M.value)}async function _e(d,s=!1){window.confirm("¿Seguro que quieres eliminar esta publicación?")&&(await ve(P(b,"feed_posts",d)),s&&re())}function ye(d){W.value=d.id,F.value=d.text}function he(){W.value=null,F.value=""}async function Ce(d,s,t=!1){if(!F.value.trim())return;const o=P(b,"feed_posts",d.id),y=d.comments.map(g=>g.id===s.id?{...g,text:F.value}:g);await se(o,{comments:y}),W.value=null,F.value="",t&&c.value&&(c.value.comments=y)}async function ke(d,s,t=!1){if(!window.confirm("¿Seguro que quieres eliminar este comentario?"))return;const o=P(b,"feed_posts",d.id),y=d.comments.filter(g=>g.id!==s.id);await se(o,{comments:y}),t&&c.value&&(c.value.comments=y)}function Ue(d,s,t=!1){Y.value=d+"-"+s,setTimeout(()=>{Y.value=""},500),Re(d,s,t)}function De(d){d&&Q(d)}return(d,s)=>(a(),i("div",zs,[J(Ye,{user:l.value,isSidebarCollapsed:oe.value,activeSection:Z.value,pendingRequestsCount:X.value,onToggleSidebar:ae,"onUpdate:activeSection":s[0]||(s[0]=t=>Z.value=t)},null,8,["user","isSidebarCollapsed","activeSection","pendingRequestsCount"]),e("div",Ls,[Z.value==="chat"?(a(),xe(Me,{key:0})):Z.value==="friends"?(a(),xe(Gs,{key:1,user:l.value},null,8,["user"])):(a(),i(w,{key:2},[e("div",Bs,[e("button",{class:"btn btn-primary",onClick:s[1]||(s[1]=t=>$.value=!0)}," Crear publicación ")]),J(ue,{name:"fade-modal"},{default:ee(()=>[_.value?(a(),i("div",{key:0,class:"modal-feed",onClick:R(H,["self"])},[e("div",Hs,[J(qe,{uid:_.value,onClose:H},null,8,["uid"])])])):U("",!0)]),_:1}),J(ue,{name:"fade-modal"},{default:ee(()=>[$.value?(a(),i("div",Js,[e("div",{class:"modal-background",onClick:q}),e("div",Ks,[e("header",{class:"modal-card-head"},[s[16]||(s[16]=e("p",{class:"modal-card-title"},"Nueva publicación",-1)),e("button",{class:"delete",onClick:q})]),e("section",Ws,[e("form",{onSubmit:R(T,["prevent"])},[e("div",Xs,[s[17]||(s[17]=e("label",{class:"label"},"Título",-1)),e("div",Ys,[V(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>u.value=t),class:"input",placeholder:"Título",required:""},null,512),[[L,u.value]])])]),e("div",Zs,[s[18]||(s[18]=e("label",{class:"label"},"Mensaje",-1)),e("div",et,[V(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=t=>D.value=t),class:"textarea",placeholder:"¿Qué quieres compartir?",rows:"3",required:""},null,512),[[L,D.value]])])]),e("div",st,[s[19]||(s[19]=e("label",{class:"label"},"URL de imagen (opcional)",-1)),e("div",tt,[V(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>A.value=t),class:"input",placeholder:"URL de imagen",type:"url"},null,512),[[L,A.value]])])]),e("div",nt,[s[22]||(s[22]=e("label",{class:"label"},"Visibilidad",-1)),e("div",ot,[e("label",at,[V(e("input",{type:"radio",value:"public","onUpdate:modelValue":s[5]||(s[5]=t=>x.value=t)},null,512),[[Se,x.value]]),s[20]||(s[20]=G(" Público"))]),e("label",it,[V(e("input",{type:"radio",value:"friends","onUpdate:modelValue":s[6]||(s[6]=t=>x.value=t)},null,512),[[Se,x.value]]),s[21]||(s[21]=G(" Solo amigos"))])])]),e("footer",{class:"modal-card-foot buttons"},[s[23]||(s[23]=e("button",{class:"btn btn-primary",type:"submit"}," Publicar ",-1)),e("button",{class:"btn button is-danger has-text-white-bis",type:"button",onClick:q}," Cancelar ")])],32)])])])):U("",!0)]),_:1}),J(ce,{name:"fade-list",tag:"div",class:"feed-list"},{default:ee(()=>[(a(!0),i(w,null,K(f.value,t=>(a(),i("div",{key:t.id,class:"feed-post"},[e("div",lt,[e("img",{class:"avatar",src:t.user.avatar,alt:"avatar",onClick:o=>Q(t.user.uid),style:{cursor:"pointer"}},null,8,dt),e("div",rt,[e("span",ut,m(t.user.name),1),e("span",ct,m(t.date||""),1)]),t.user.uid===l.value.uid?(a(),i("div",vt,[e("button",{class:"btn-icon",onClick:o=>pe(t)},s[24]||(s[24]=[e("i",{class:"bx bx-edit"},null,-1)]),8,mt),e("button",{class:"btn-icon",onClick:o=>_e(t.id)},s[25]||(s[25]=[e("i",{class:"bx bx-trash"},null,-1)]),8,ft)])):U("",!0)]),e("div",{class:"post-content",onClick:o=>we(t)},[B.value===t.id?(a(),i(w,{key:0},[V(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=o=>M.value=o),rows:"3",class:"edit-textarea"},null,512),[[L,M.value]]),e("div",bt,[e("button",{class:"btn btn-primary",onClick:R(o=>ge(t),["stop"])}," Guardar ",8,gt),e("button",{class:"btn btn-accent",onClick:R(be,["stop"])}," Cancelar ")])],64)):(a(),i(w,{key:1},[e("p",null,m(t.content),1),t.image?(a(),i("img",{key:0,src:t.image,class:"post-img",alt:"imagen de publicación"},null,8,_t)):U("",!0)],64))],8,pt),e("div",yt,[(a(),i(w,null,K(h,o=>e("button",{key:o.type,class:z(["reaction-btn",{selected:t.userReaction===o.type,bounce:Y.value===t.id+"-"+o.type}]),onClick:y=>Ue(t.id,o.type)},[e("span",{"aria-label":o.label},m(o.emoji),9,Ct),t.reactions[o.type]?(a(),i("span",kt,m(t.reactions[o.type]),1)):U("",!0)],10,ht)),64))]),J(ce,{name:"fade-list",tag:"div",class:"post-comments"},{default:ee(()=>[(a(!0),i(w,null,K(t.comments,o=>(a(),i("div",{key:o.id,class:"comment"},[e("img",{class:"avatar avatar-sm",src:o.avatar,alt:"avatar",onClick:y=>De(o.uid),style:{cursor:"pointer"}},null,8,Ut),e("div",$t,[W.value===o.id?(a(),i(w,{key:0},[V(e("input",{"onUpdate:modelValue":s[8]||(s[8]=y=>F.value=y),class:"edit-comment-input"},null,512),[[L,F.value]]),e("div",xt,[e("button",{class:"btn btn-primary",onClick:R(y=>Ce(t,o),["stop"])}," Guardar ",8,St),e("button",{class:"btn btn-accent",onClick:R(he,["stop"])}," Cancelar ")])],64)):(a(),i(w,{key:1},[e("span",It,m(o.user),1),e("span",Rt,m(o.text),1),o.uid===l.value.uid?(a(),i("span",wt,[e("button",{class:"btn-icon",onClick:R(y=>ye(o),["stop"])},s[26]||(s[26]=[e("i",{class:"bx bx-edit"},null,-1)]),8,Dt),e("button",{class:"btn-icon",onClick:R(y=>ke(t,o),["stop"])},s[27]||(s[27]=[e("i",{class:"bx bx-trash"},null,-1)]),8,Et)])):U("",!0)],64))])]))),128))]),_:2},1024),e("form",{class:"add-comment-form",onSubmit:R(o=>fe(t.id),["prevent"])},[V(e("input",{"onUpdate:modelValue":o=>O[t.id]=o,placeholder:"Agrega un comentario..."},null,8,At),[[L,O[t.id]]]),s[28]||(s[28]=e("button",{type:"submit",class:"btn btn-accent"},"Comentar",-1))],40,Nt)]))),128))]),_:1}),J(ue,{name:"fade-modal"},{default:ee(()=>[c.value?(a(),i("div",{key:0,class:"modal-feed",onClick:R(re,["self"])},[e("div",Pt,[e("button",{class:"modal-close",onClick:re},"×"),e("div",qt,[e("img",{class:"avatar",src:c.value.user.avatar,alt:"avatar"},null,8,Mt),e("div",Ft,[e("span",Tt,m(c.value.user.name),1),e("span",Vt,m(c.value.date||""),1)]),c.value.user.uid===l.value.uid?(a(),i("div",jt,[e("button",{class:"btn-icon",onClick:s[9]||(s[9]=t=>pe(c.value,!0))},s[29]||(s[29]=[e("i",{class:"bx bx-edit"},null,-1)])),e("button",{class:"btn-icon",onClick:s[10]||(s[10]=t=>_e(c.value.id,!0))},s[30]||(s[30]=[e("i",{class:"bx bx-trash"},null,-1)]))])):U("",!0)]),e("div",Ot,[B.value===c.value.id?(a(),i(w,{key:0},[V(e("textarea",{"onUpdate:modelValue":s[11]||(s[11]=t=>M.value=t),rows:"3",class:"edit-textarea"},null,512),[[L,M.value]]),e("div",Qt,[e("button",{class:"btn btn-primary",onClick:s[12]||(s[12]=R(t=>ge(c.value,!0),["stop"]))}," Guardar "),e("button",{class:"btn btn-accent",onClick:R(be,["stop"])}," Cancelar ")])],64)):(a(),i(w,{key:1},[e("p",null,m(c.value.content),1),c.value.image?(a(),i("img",{key:0,src:c.value.image,class:"post-img",alt:"imagen de publicación"},null,8,Gt)):U("",!0)],64))]),e("div",zt,[(a(),i(w,null,K(h,t=>e("button",{key:t.type,class:z(["reaction-btn",{selected:c.value.userReaction===t.type,bounce:Y.value===c.value.id+"-"+t.type}]),onClick:o=>Ue(c.value.id,t.type,!0)},[e("span",{"aria-label":t.label},m(t.emoji),9,Bt),c.value.reactions[t.type]?(a(),i("span",Ht,m(c.value.reactions[t.type]),1)):U("",!0)],10,Lt)),64))]),J(ce,{name:"fade-list",tag:"div",class:"post-comments"},{default:ee(()=>[(a(!0),i(w,null,K(c.value.comments,t=>(a(),i("div",{key:t.id,class:"comment"},[e("img",{class:"avatar avatar-sm",src:t.avatar,alt:"avatar"},null,8,Jt),e("div",Kt,[W.value===t.id?(a(),i(w,{key:0},[V(e("input",{"onUpdate:modelValue":s[13]||(s[13]=o=>F.value=o),class:"edit-comment-input"},null,512),[[L,F.value]]),e("div",Wt,[e("button",{class:"btn btn-primary",onClick:R(o=>Ce(c.value,t,!0),["stop"])}," Guardar ",8,Xt),e("button",{class:"btn btn-accent",onClick:R(he,["stop"])}," Cancelar ")])],64)):(a(),i(w,{key:1},[e("span",Yt,m(t.user),1),e("span",Zt,m(t.text),1),t.uid===l.value.uid?(a(),i("span",en,[e("button",{class:"btn-icon",onClick:R(o=>ye(t),["stop"])},s[31]||(s[31]=[e("i",{class:"bx bx-edit"},null,-1)]),8,sn),e("button",{class:"btn-icon",onClick:R(o=>ke(c.value,t,!0),["stop"])},s[32]||(s[32]=[e("i",{class:"bx bx-trash"},null,-1)]),8,tn)])):U("",!0)],64))])]))),128))]),_:1}),e("form",{class:"add-comment-form",onSubmit:s[15]||(s[15]=R(t=>fe(c.value.id,!0),["prevent"]))},[V(e("input",{"onUpdate:modelValue":s[14]||(s[14]=t=>O[c.value.id]=t),placeholder:"Agrega un comentario..."},null,512),[[L,O[c.value.id]]]),s[33]||(s[33]=e("button",{type:"submit",class:"btn btn-accent"},"Comentar",-1))],32)])])):U("",!0)]),_:1})],64))])]))}},mn=me(nn,[["__scopeId","data-v-28dbb494"]]);export{mn as default};
